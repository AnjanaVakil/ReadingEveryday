## broker和集群

一个独立的kafka服务器被称为broker。

1. broker接受来自生产者的消息，为消息设置偏移量，并提交消息到磁盘保存。
2. broker为消费者提供服务，对读取分区的请求作出响应，返回已经提交到磁盘上的消息。
3. 根据特定的硬件及性能特征，单个broker可以轻松处理数千个分区以及每秒百万级的消息量

broker是集群的组成部分，每个集群都有一个同时充当集群控制器角色的broker。控制器负责管理工作，包括为broker分配分区和监控broker。每个分区都有一个broker首领。

保留消息是Kafka的一个重要特性，broker默认的保留策略是这样的，要么保留一段时间，要么保留消息总理达到一定的字节数。

## 多集群

随着Kafka部署的增加，基于以下几个原因，最好使用多个集群：

1. 数据类型分离
2. 安全需求隔离
3. 多数据中心（灾难恢复）

如果使用多个数据中心，就涉及到消息同步。

# 为什么选择Kafka

1. 支持多个生产者
2. 支持多个消费者：消费者之间互不影响；多个消费者可以组成一个群组，它们共享一个消息，并保证整个群组对每个给定的消息只处理一次。
3. 基于磁盘的数据存储：消息持久化，允许非实时地读取数据
4. 伸缩性：随着数据量增长，可以横向扩展broker
5. 高性能

# 数据生态系统

kafka相当于是一个中间层，一个订阅发布系统，一个数据转换组件，接受各种各样的数据类型，再将其写回数据基础设施。

解偶了生产者和消费者。

## 应用场景

1. 活动跟踪：埋点发消息
2. 传递消息：
3. 度量指标和日志记录
4. 提交日志：数据库的提交日志，订阅日志可以进行数据复制
5. 流处理


# Kafka的诞生

kafka起源于 linkedin的度量指标监控，最开始是轮询拉取度量指标，但有很多缺点：

1. 指标间隔时间较长
2. 使用不方便
3. 一致性较差，同一个度量指标的名字在不同系统里的叫法不一样
4. 。。。


LinkedIn的Jay Kreps领导开放了Kafka项目，主要目标是：

1. 生产者和消费者的解偶
2. 数据持久化，以便支持多个消费者
3. 高吞吐量
4. 系统可以随着数据增长实现横向扩展

最终走向了开源。

2014年秋天，Jay Kreps、Neha Narkhede和Jun Rao离开LinkedIn，创办了Confluent。
