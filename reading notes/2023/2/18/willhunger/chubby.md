分布式系统中需要解决各类的协调需求，动例如态配置管理，以及以下问题：
* 主备切换
* 水平扩展
* 分布式锁服务
* 多进程或机器中实现任务同步
* 某台机器是否存活
* 如何快速构建生产者-消费者消息队列

## Chubby
特点：
* 粗粒度锁服务，用于实现资源协调问题。
* 粗粒度值的是锁的持有时间较长，好处：对锁服务器请求的负载较低，支持更高的并发度。
* 设计目标：**强调系统的可靠性、高可用性及语义易于理解**，不追求读/写请求的高吞吐以及协调系统内存储大量数据。
* 基于 Paxos 一致性协议，增加中心管理策略。

### 系统架构
通过 Paxos 一致性协议选主，所有读写操作都有主控服务器完成，在内存中维护和主控服务器一致的树形结构（树型结构中的内容即为加锁对象或者数据存储对象）。
其中：
* 主控服务器有租约机制，租约过期后会触发投票选主；特别的，如果无故障情况发生，在选主阶段，系统还是尽量将租约交给原先的主控服务器。
* 如果备份服务器长时间故障，Chubby 会调度加入一条新机器加入系统中承担备份服务器的角色，同时更新系统 DNS 信息，并将新机器的地址替换原故障机地址；主控服务器会周期轮询 DNS 信息，会通过一致性协议将变化通知给其它备份服务器。
* 一致性问题上，多数备份服务器接收更新后，主控服务器会认为本次更新操作正确完成。

### 数据模型
Chubby 类似于文件系统的目录和文件管理系统，并在此基础上提供针对目录和文件的锁服务。
* Chubby 文件存储一些管理信息或基础数据，要求对文件内容一次性全部读完或者写完以尽可能抑制客户端写入大量文件中，**因为 Chubby 的目的并不是数据存储，而是对资源的同步管理。**
* Chubby 提供了文件内容或者目录更改后的通知机制，客户端可以订阅某个文件或者目录，但其中内容发生变动时，Chubby 会主动通知这些订阅该文件或目录的客户端，以使得这种信息变化得以及时传播


