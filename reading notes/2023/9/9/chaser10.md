### 持久化
##### Q：AOF持久化是怎么实现的
- 区别于WAL AOF持久化是有数据丢失的风险的 核心思想就是在执行一条写操作 将这条写操作写入到缓存区当中 然后有三种策略决定写入到硬盘AOF文件的时机
	- always 每一次都刷入硬盘
	- no 将何时刷入交给操作系统
	- everysec 每隔一秒刷入硬盘
- 重写机制，（反复增删后 aof会变得有很多多余数据）当aof文件大于阈值时触发重写机制，此时主进程会fork一个子进程，(**fork的子进程对于共享的数据是写时复制 读时共享**)子进程共享主进程的物理内存，并将数据副本的键值对转化成命令写入到新的aof文件 而在子进程后台重写时 主进程是不阻塞的 他会把重写过程中新增的数据写入到aof重写缓冲区 待子进程重写完成后会将重写缓冲区追加到 aof文件中
##### Q：RDB快照是怎么实现的？
- RDB快照是redis数据库的全量快照 也就是会保存内存中的所有数据已二进制格式保存 保存快照有两种
	- save会阻塞主线程
	- bgsave通过fork创建子进程 在后台进行保存快照 **fork会共享主线程的物理内存，当主线程要写一块数据时 会进行写时复制**
##### Q：RDB快照和AOF如何混合使用？
- 在AOF文件达到阈值触发重写机制时，fork出来的重写子进程首先会先以rdb的方式将数据写入AOF文件 待写入完成后将主线程在重写过程中写入重写缓冲区的数据以aof方式写入aof文件  此时aof文件前半部分是触发重写时redis的全量快照 后半部分是重写过程中主线程新增的数据

### 数据结构
##### Q：redis hash插入5个数据和5000个数据的存储区别
- 如果哈希类型元素小于512个采用listpack 大于的话则采用哈希表

### 集群
##### Q：Redis集群里有几个槽
- 16384