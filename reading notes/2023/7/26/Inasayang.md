类型转换、赋值和值比较规则大全

类型转换规则大全

-   显然的类型转换规则
    -   两个类型表示着同一个类型，则它们的值可以相互隐式转换为这两个类型中的任意一个
        -   类型byte和uint8的任何值可以转换为这两个类型中的任意一个
        -   类型rune和int32的任何值可以转换为这两个类型中的任意一个
        -   类型[]byte和[]uint8的任何值可以转换为这两个类型中的任意一个
-   底层类型相关的类型转换规则
    -   一个非接口值x和一个非接口类型T，假设x的类型为Tx
        -   如果类型Tx和T的底层类型相同（忽略掉结构体字段标签），则x可以被显式转换为类型T
        -   如果类型Tx和T中至少有一个是无名类型并且它们的底层类型相同（考虑结构体字段标签），则x可以被隐式转换为类型T
        -   如果类型Tx和T的底层类型不同，但是两者都是无名的指针类型并且它们的基类型的底层类型相同（忽略掉结构体字段标签），则x可以（而且只能）被显式转换为类型T
-   通道相关的类型转换规则
    -   一个通道值x，假设它的类型Tx是一个双向通道类型，T也是一个通道类型（无论是双向的还是单向的）。如果Tx和T的元素类型相同并且它们中至少有一个为无名类型，则x可以被隐式转换为类型T
-   和接口实现相关的类型转换规则
    -   一个值x和一个接口类型I，如果x的类型（或者默认类型）为Tx并且类型Tx实现了接口类型I，则x可以被隐式转换为类型I。 此转换的结果为一个类型为I的接口值。此接口值包裹了
        -   x的一个副本（如果Tx是一个非接口值）
        -   x的动态值的一个副本（如果Tx是一个接口值）
-   类型不确定值相关的类型转换规则
-   常量相关的类型转换规则
    -   常量的类型转换结果一般仍然是一个常量
    -   一个常量值x和一个类型T，如果x可以表示成类型T的一个值，则x可以被显式地转换为类型T
    -   如果x是一个类型不确定值，则它可以被隐式转换为类型T
-   非常量数值转换规则
    -   非常量浮点数和整数值可以被显式转换为任何浮点数和整数类型
    -   非常量复数值可以被显式转换为任何复数类型
    -   非常量复数值不能被转换为浮点数或整数类型
    -   非常量浮点数和整数值不能被转换为复数类型
    -   在非常量数值的转换过程中，溢出和舍入是允许的。当一个浮点数被转换为整数时，小数部分将被舍弃（向零靠拢）
-   字符串相关的转换规则
    -   如果一个值的类型（或者默认类型）为一个整数类型，则此值可以被当作一个码点值（rune值）显式转换为任何字符串类型
    -   一个字符串可以被显式转换为一个字节切片类型，反之亦然。 字节切片类型是指底层类型为[]byte的类型
    -   一个字符串可以被显式转换为一个码点切片类型，反之亦然。 码点切片类型是指底层类型为[]rune的类型
-   切片相关的类型转换规则
    -   一个切片可以被转化为一个相同元素类型的数组
    -   如果数组的长度大于被转化切片的长度，则将导致恐慌产生
-   非类型安全指针相关的类型转换规则
    -   非类型安全指针类型是指底层类型为`unsafe.Pointer`的类型
    -   任何类型安全指针类型的值可以被显式转化为一个非类型安全指针类型，反之亦然
    -   任何`uintptr`值可以被显式转化为一个非类型安全指针类型，反之亦然



Pp. 491-497